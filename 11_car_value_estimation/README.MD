# Оценка стоимости автомобиля

### Задача

Нужно построить модель для оценки (предсказания) стоимости автомобиля по его характеристикам.

Заказчику важны время обучения и качество и скорость предсказания.

### Данные

В нашем распоряжении исторические данные: технические характеристики, комплектации и цены автомобилей.

### Ход работы

1. Знакомство и предобработка данных:
    1. удаление признаков, не описывающих автомобиль (например, время последнего визита продавца);
    2. обработка пропусков,
    3. поиск дубликатов.
2. Подготовка данных к обучению:
    1. обработка выбросов,
    2. порядковое кодирование категориальных признаков,
    3. разбиение данных на обучающую и тестовую выборки,
    4. масштабирование численных признаков.
3. Обучение разных видов моделей.
4. Сравнение моделей и подведение итогов.

### Выводы

**Градиентный бустинг и линейные модели**

Лидером исследования по качеству стал градиентный бустинг. RMSE лучшей модели при валидации — 1780 евро. Однако это все равно большая ошибка. Медианная стоимость машин в тестовой выборке — 2700 евро. Ошибка в 1780 евро составляет 66% от нее, что очень много.

Несмотря на то, что бустинг лишь третий по скорости обучения, он все равно быстро обучился — всего за 36,7 секунды.

По скорости бустинг обгоняют только линейные модели, у которых гораздо хуже качество: RMSE и линейной регрессии, и градиентного спуска больше 3000 евро. При этом градиентный спуск обучился всего на 12 секунд быстрее. Такое небольшое уменьшение времени обучения не может компенсировать плохое качество.

**Случайный лес и время предсказаний**

Дольше всех обучался случайный лес — больше трех минут. Зато у него высокое качество предсказаний: RMSE на валидации лишь немного уступает бустингу (1838 и 1780 евро соответственно).

Также случайный лес дольше всех делает предсказания. Хотя этот параметр, мне кажется, некритичным, потому что даже случайный лес оценил 60 тысяч машин всего за 408 миллисекунд.

### Используемые библиотеки

pandas, matplotlib, seaborn, sklearn, lightgbm